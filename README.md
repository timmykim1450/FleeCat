# Fleecat ë©€í‹°í…Œë„ŒíŠ¸ ì‡¼í•‘ëª° í”Œë«í¼

> ì—¬ëŸ¬ ê³µë°©(íŒë§¤ì‚¬)ì´ í•˜ë‚˜ì˜ í”Œë«í¼ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ ìƒí’ˆì„ íŒë§¤í•  ìˆ˜ ìˆëŠ” ë©€í‹°í…Œë„ŒíŠ¸ ì´ì»¤ë¨¸ìŠ¤ ë°±ì—”ë“œ API

**ê°œë°œ ê¸°ê°„**: 2025ë…„ 10ì›” 1ì¼ ~ ì§„í–‰ ì¤‘
**ê¸°ìˆ  ìŠ¤íƒ**: Node.js, Express, Prisma, PostgreSQL (Supabase), JWT
**ì•„í‚¤í…ì²˜**: Layered Architecture (Repository Pattern)

---

## ğŸ“– í”„ë¡œì íŠ¸ ê°œìš”

### í•µì‹¬ ì»¨ì…‰

Fleecatì€ **ë©€í‹°í…Œë„ŒíŠ¸ ì‡¼í•‘ëª° í”Œë«í¼**ìœ¼ë¡œ, ì—¬ëŸ¬ ê³µë°©(íŒë§¤ì‚¬)ì´ í•˜ë‚˜ì˜ í”Œë«í¼ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ ìš´ì˜ë˜ë©´ì„œë„ í†µí•©ëœ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤.

### ì£¼ìš” íŠ¹ì§•

1. **ë©€í‹°í…Œë„Œì‹œ (Multi-Tenancy)**
   - í•œ í”Œë«í¼ì— ì—¬ëŸ¬ íŒë§¤ì‚¬(Tenant) ê³µì¡´
   - íŒë§¤ì‚¬ë³„ ë°ì´í„° ê²©ë¦¬ ë° ë…ë¦½ì  ìš´ì˜
   - í•œ íšŒì›ì´ ì—¬ëŸ¬ íŒë§¤ì‚¬ì— ì†Œì† ê°€ëŠ¥

2. **ìœ ì—°í•œ ê¶Œí•œ ê´€ë¦¬**
   - êµ¬ë§¤ì(Buyer), íŒë§¤ì(Seller), ê´€ë¦¬ì(Admin) ì—­í•  êµ¬ë¶„
   - íŒë§¤ì‚¬ë³„ êµ¬ì„±ì›(TenantMember) ìŠ¹ì¸ ì‹œìŠ¤í…œ
   - ì„¸ë°€í•œ ê¶Œí•œ ì œì–´ (ìƒí’ˆ ê´€ë¦¬, ì£¼ë¬¸ ì²˜ë¦¬ ë“±)

3. **ê³„ì¸µí˜• ì¹´í…Œê³ ë¦¬**
   - ëŒ€ë¶„ë¥˜ â†’ ì¤‘ë¶„ë¥˜ â†’ ì†Œë¶„ë¥˜ êµ¬ì¡°
   - ìê¸° ì°¸ì¡°(Self-referencing) ê´€ê³„
   - ë™ì  ê²½ë¡œ(Path) ìë™ ìƒì„±

4. **ì™„ì „í•œ ì´ì»¤ë¨¸ìŠ¤ ê¸°ëŠ¥**
   - íšŒì› ê´€ë¦¬ (ê°œì¸/ê¸°ì—… êµ¬ë¶„)
   - ìƒí’ˆ ê´€ë¦¬ (ì´ë¯¸ì§€, ì¬ê³ , ê°€ê²©)
   - ì¥ë°”êµ¬ë‹ˆ ë° ì£¼ë¬¸
   - ì¿ í° ë° ê²°ì œ
   - ë°°ì†¡ì§€ ê´€ë¦¬

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### ë ˆì´ì–´ë“œ ì•„í‚¤í…ì²˜ (Layered Architecture)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Routes (API Endpoints)        â”‚  â† HTTP ìš”ì²­ ìˆ˜ì‹ , ë¼ìš°íŒ…
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Middleware (Auth, Validation)      â”‚  â† ì¸ì¦, ê²€ì¦, ì—ëŸ¬ ì²˜ë¦¬
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Controllers (Request Handlers)      â”‚  â† HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Services (Business Logic)          â”‚  â† ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§, íŠ¸ëœì­ì…˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Repositories (Data Access Layer)     â”‚  â† ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Prisma ORM (Query Builder)         â”‚  â† SQL ì¿¼ë¦¬ ìƒì„±
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    PostgreSQL Database (Supabase)       â”‚  â† ë°ì´í„° ì €ì¥
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì£¼ìš” ì›ì¹™

- **ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬**: ê° ë ˆì´ì–´ëŠ” ëª…í™•í•œ ì±…ì„ì„ ê°€ì§
- **ì˜ì¡´ì„± ì—­ì „**: ìƒìœ„ ë ˆì´ì–´ê°€ í•˜ìœ„ ë ˆì´ì–´ì— ì˜ì¡´
- **Repository íŒ¨í„´**: ë°ì´í„° ì ‘ê·¼ ë¡œì§ì„ ìº¡ìŠí™”
- **ë‹¨ì¼ ì±…ì„ ì›ì¹™**: ê° í•¨ìˆ˜ì™€ íŒŒì¼ì€ í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì§

---

## ğŸ”‘ í•µì‹¬ ê°œë…

### 1. ë©€í‹°í…Œë„Œì‹œ êµ¬ì¡°

**Tenant (íŒë§¤ì‚¬/ê³µë°©)**
- í”Œë«í¼ ë‚´ ë…ë¦½ì ì¸ íŒë§¤ ë‹¨ìœ„
- ì˜ˆ: "í™ê¸¸ë™ ë„ìê¸° ê³µë°©", "ê¹€ì² ìˆ˜ ëª©ê³µì˜ˆ ê³µë°©"

**TenantMember (íŒë§¤ì‚¬ êµ¬ì„±ì›)**
- íšŒì›ê³¼ íŒë§¤ì‚¬ë¥¼ ì—°ê²°í•˜ëŠ” ì¤‘ê°„ í…Œì´ë¸”
- í•œ íšŒì›ì´ ì—¬ëŸ¬ íŒë§¤ì‚¬ì— ì†Œì† ê°€ëŠ¥
- ì—­í• (Role): owner, manager, staff

**ê´€ê³„ êµ¬ì¡°**:
```
Member (íšŒì›)
  â†“ N:N (ë‹¤ëŒ€ë‹¤)
TenantMember (êµ¬ì„±ì›)
  â†“ 1:N (ì¼ëŒ€ë‹¤)
Product (ìƒí’ˆ)
```

**í•µì‹¬ í¬ì¸íŠ¸**:
- ìƒí’ˆì€ Tenantê°€ ì•„ë‹Œ **TenantMember**ì— ì†í•¨
- í•œ íšŒì›ì´ "Aê³µë°©"ê³¼ "Bê³µë°©"ì—ì„œ ê°ê° ë‹¤ë¥¸ ìƒí’ˆì„ íŒë§¤ ê°€ëŠ¥
- íŒë§¤ì‚¬ë³„ ë°ì´í„° ê²©ë¦¬ë¥¼ í†µí•´ ë…ë¦½ì„± ë³´ì¥

---

### 2. ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ (Approval Process)

**2ë‹¨ê³„ ìŠ¹ì¸ ì‹œìŠ¤í…œ**:

```
1ë‹¨ê³„: íŒë§¤ì‚¬ ìŠ¹ì¸ (ê´€ë¦¬ì)
íšŒì› â†’ íŒë§¤ì‚¬ ë“±ë¡ ì‹ ì²­ (pending)
      â†“
ê´€ë¦¬ì â†’ ìŠ¹ì¸(approved) / ê±°ì ˆ(rejected)

2ë‹¨ê³„: êµ¬ì„±ì› ìŠ¹ì¸ (íŒë§¤ì‚¬ Owner)
íšŒì› â†’ íŒë§¤ì‚¬ ê°€ì… ì‹ ì²­ (pending)
      â†“
íŒë§¤ì‚¬ Owner â†’ ìŠ¹ì¸(approved) / ê±°ì ˆ(rejected)
```

**ìŠ¹ì¸ í›„ ê¶Œí•œ**:
- íŒë§¤ì‚¬ ìŠ¹ì¸: êµ¬ì„±ì› ëª¨ì§‘ ê°€ëŠ¥
- êµ¬ì„±ì› ìŠ¹ì¸: ìƒí’ˆ ë“±ë¡ ë° ê´€ë¦¬ ê°€ëŠ¥

---

### 3. ê³„ì¸µí˜• ì¹´í…Œê³ ë¦¬

**ìê¸° ì°¸ì¡° êµ¬ì¡°** (Self-Referencing):
```
category
  â”œâ”€ category_id (PK)
  â”œâ”€ parent_category_id (FK â†’ category_id)
  â”œâ”€ category_path (ìë™ ìƒì„±)
  â””â”€ category_depth (1, 2, 3...)
```

**ê²½ë¡œ ìë™ ìƒì„±**:
- ëŒ€ë¶„ë¥˜ (ID: 1): `path = "1"`
- ì¤‘ë¶„ë¥˜ (ID: 5): `path = "1/5"` (ë¶€ëª¨: 1)
- ì†Œë¶„ë¥˜ (ID: 12): `path = "1/5/12"` (ë¶€ëª¨: 5)

**ê³„ì¸µ ì¡°íšŒ**:
- ë¶€ëª¨ ì¹´í…Œê³ ë¦¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìì‹ ì¹´í…Œê³ ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ ì¡°íšŒ
- ì „ì²´ íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ í•œ ë²ˆì— ë°˜í™˜ ê°€ëŠ¥

---

### 4. JWT ì¸ì¦ ì‹œìŠ¤í…œ

**í† í° ê¸°ë°˜ ì¸ì¦**:
```
1. ë¡œê·¸ì¸ â†’ JWT í† í° ë°œê¸‰
2. ìš”ì²­ ì‹œ Authorization í—¤ë”ì— í† í° í¬í•¨
3. ë¯¸ë“¤ì›¨ì–´ì—ì„œ í† í° ê²€ì¦
4. ê²€ì¦ ì„±ê³µ ì‹œ req.userì— ì‚¬ìš©ì ì •ë³´ ì €ì¥
```

**ê¶Œí•œ ì²´í¬**:
- `authenticate`: ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸
- `authorize(role)`: íŠ¹ì • ì—­í•  í™•ì¸
- Custom ë¯¸ë“¤ì›¨ì–´: ì„¸ë¶€ ê¶Œí•œ í™•ì¸ (owner, ë³¸ì¸ ë“±)

**í† í° í˜ì´ë¡œë“œ**:
```javascript
{
  member_id: 123,
  email: "user@example.com",
  role: "seller",
  roles: ["buyer", "seller"]
}
```

---

### 5. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ ì›ì¹™

**ë„¤ì´ë° ê·œì¹™**:
- í…Œì´ë¸”ëª…: ë‹¨ìˆ˜í˜• ì†Œë¬¸ì (`member`, `product`)
- ì»¬ëŸ¼ëª…: `{í…Œì´ë¸”}_{ì»¬ëŸ¼}` í˜•ì‹ (`member_email`, `product_price`)
- Primary Key: `{í…Œì´ë¸”}_id` (`member_id`, `tenant_id`)
- Foreign Key: `{ì°¸ì¡°í…Œì´ë¸”}_id` (`company_id`, `category_id`)

**íƒ€ì„ìŠ¤íƒ¬í”„**:
- ëª¨ë“  í…Œì´ë¸”ì— `{í…Œì´ë¸”}_created_at`, `{í…Œì´ë¸”}_updated_at` í•„ìˆ˜
- Prisma `@updatedAt`ë¡œ ìë™ ê°±ì‹ 

**CASCADE ì •ì±…**:
- **CASCADE DELETE**: `member_address`, `product_img`, `shopping_cart`
  - ë¶€ëª¨ ì‚­ì œ ì‹œ ìì‹ë„ í•¨ê»˜ ì‚­ì œ (1:N ê´€ê³„)
- **RESTRICT**: `order`, `payment`
  - ì£¼ë¬¸/ê²°ì œ ì´ë ¥ì€ ë³´ì¡´ (ë²•ì  ìš”êµ¬ì‚¬í•­)
- **SET NULL**: `coupon_id` in `order`
  - ì¿ í° ì‚­ì œ ì‹œ ì£¼ë¬¸ì€ ìœ ì§€, ì¿ í°ë§Œ NULL

---

## ğŸ“Š ê°œë°œ ì§„í–‰ í˜„í™©

### Phase 1: ê¸°ì´ˆ ì¸í”„ë¼ êµ¬ì¶• âœ… **ì™„ë£Œ**

**ëª©í‘œ**: íšŒì› ê°€ì…ë¶€í„° ë¡œê·¸ì¸ê¹Œì§€ ê¸°ë³¸ ì¸ì¦/ì¸ê°€ ì‹œìŠ¤í…œ êµ¬ì¶•

**êµ¬í˜„ ì™„ë£Œ** (2025.10.01 ~ 2025.10.02):
- âœ… íšŒì›ê°€ì… API (ê°œì¸/ê¸°ì—… êµ¬ë¶„)
- âœ… ë¡œê·¸ì¸ API (JWT í† í° ë°œê¸‰)
- âœ… ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ API
- âœ… ë‚´ ì •ë³´ ì¡°íšŒ API
- âœ… ë‚´ ì •ë³´ ìˆ˜ì • API

**ì£¼ìš” ì„±ê³¼**:
- 13ê°œ Step ëª¨ë‘ ì™„ë£Œ (100%)
- 5ê°œ Critical ë²„ê·¸ ë°œê²¬ ë° ìˆ˜ì •
- 12ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì™„ë£Œ (í†µê³¼ìœ¨ 100%)
- 16ê°œ ë¬¸ì„œ ì‘ì„± ì™„ë£Œ

**ë°œê²¬ ë° ìˆ˜ì •ëœ ë²„ê·¸**:
1. Prisma ê´€ê³„ í•„ë“œëª… ì˜¤ë¥˜ (`member_permission` â†’ `member_permissions`) - 3ê³³
2. BigInt ì§ë ¬í™” ì˜¤ë¥˜ (ê´€ê³„ ë°ì´í„° ë¯¸ì œê±°) - 2ê³³

---

### Phase 2: íŒë§¤ì ê¸°ëŠ¥ êµ¬ì¶• ğŸ“‹ **ê³„íš ìˆ˜ë¦½ ì™„ë£Œ**

**ëª©í‘œ**: íŒë§¤ì‚¬ ë“±ë¡ë¶€í„° ìƒí’ˆ ë“±ë¡ê¹Œì§€ ë©€í‹°í…Œë„ŒíŠ¸ í•µì‹¬ ê¸°ëŠ¥ êµ¬ì¶•

**ê³„íšëœ ì‘ì—…** (14ê°œ Step):

**Repository Layer** (6ê°œ):
1. Tenant Repository - íŒë§¤ì‚¬ ë°ì´í„° ì ‘ê·¼
2. TenantDetail Repository - íŒë§¤ì‚¬ ìƒì„¸ ì •ë³´
3. TenantMember Repository - íŒë§¤ì‚¬ êµ¬ì„±ì› ê´€ë¦¬
4. Category Repository - ê³„ì¸µí˜• ì¹´í…Œê³ ë¦¬
5. Product Repository - ìƒí’ˆ ê´€ë¦¬
6. ProductImg Repository - ìƒí’ˆ ì´ë¯¸ì§€

**Service Layer** (4ê°œ):
7. Tenant Service - íŒë§¤ì‚¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
8. TenantMember Service - êµ¬ì„±ì› ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
9. Category Service - ì¹´í…Œê³ ë¦¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
10. Product Service - ìƒí’ˆ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

**Controller & Routes** (3ê°œ):
11. Controllers - HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
12. Validation Middleware - ì…ë ¥ ê²€ì¦
13. Routes - API ì—”ë“œí¬ì¸íŠ¸ ì •ì˜

**Testing** (1ê°œ):
14. í…ŒìŠ¤íŠ¸ ë° ë¬¸ì„œí™” - ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ë° ê²°ê³¼ ë¬¸ì„œ

**ì˜ˆì • API** (21ê°œ):
- Tenant ê´€ë¦¬: 5ê°œ
- TenantMember ê´€ë¦¬: 4ê°œ
- Category ê´€ë¦¬: 5ê°œ
- Product ê´€ë¦¬: 6ê°œ
- ì´ë¯¸ì§€ ì—…ë¡œë“œ: 1ê°œ

---

### Phase 3: êµ¬ë§¤ì ê¸°ëŠ¥ (ì˜ˆì •)

**ëª©í‘œ**: ìƒí’ˆ ì¡°íšŒë¶€í„° ì£¼ë¬¸ê¹Œì§€

**ì£¼ìš” ê¸°ëŠ¥**:
- ìƒí’ˆ ì¡°íšŒ API (ê³µê°œ, ê²€ìƒ‰, í•„í„°ë§)
- ì¥ë°”êµ¬ë‹ˆ API (ì¶”ê°€, ì¡°íšŒ, ìˆ˜ëŸ‰ ë³€ê²½, ì‚­ì œ)
- ë°°ì†¡ì§€ ê´€ë¦¬ API (CRUD, ê¸°ë³¸ ë°°ì†¡ì§€ ì„¤ì •)

---

### Phase 4: ì£¼ë¬¸ ë° ê²°ì œ (ì˜ˆì •)

**ëª©í‘œ**: ì£¼ë¬¸ ìƒì„±ë¶€í„° ê²°ì œê¹Œì§€

**ì£¼ìš” ê¸°ëŠ¥**:
- ì¿ í° API (ë°œê¸‰, ì¡°íšŒ, ì‚¬ìš©)
- ì£¼ë¬¸ API (ìƒì„±, ì¡°íšŒ, ì·¨ì†Œ)
- ê²°ì œ API (ìš”ì²­, ìŠ¹ì¸, ì·¨ì†Œ/í™˜ë¶ˆ)

---

### Phase 5: ê´€ë¦¬ì ê¸°ëŠ¥ (ì˜ˆì •)

**ëª©í‘œ**: í”Œë«í¼ ìš´ì˜ ê´€ë¦¬

**ì£¼ìš” ê¸°ëŠ¥**:
- íšŒì› ê´€ë¦¬ (ëª©ë¡, ìƒíƒœ ë³€ê²½, ê¶Œí•œ ê´€ë¦¬)
- íŒë§¤ì‚¬ ê´€ë¦¬ (ìŠ¹ì¸/ê±°ì ˆ, ì •ì§€/í•´ì œ)
- ìƒí’ˆ ê´€ë¦¬ (ìŠ¹ì¸/ê±°ì ˆ, ë¶€ì ì ˆ ìƒí’ˆ ì‚­ì œ)
- ì£¼ë¬¸ ê´€ë¦¬ (ì „ì²´ ì¡°íšŒ, ìƒíƒœ ë³€ê²½, í™˜ë¶ˆ/êµí™˜)

---

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### Backend
- **Runtime**: Node.js v18+
- **Framework**: Express.js
- **ORM**: Prisma
- **Database**: PostgreSQL (Supabase)
- **Authentication**: JWT (jsonwebtoken)
- **Validation**: express-validator
- **Password**: bcrypt

### Development
- **Testing**: Jest, Supertest (ê³„íš)
- **Manual Testing**: curl, Postman
- **Code Quality**: ESLint
- **Deployment**: Railway (ê³„íš)

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
fleecat-backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/           # ì„¤ì • íŒŒì¼ (DB ì—°ê²° ë“±)
â”‚   â”œâ”€â”€ controllers/      # HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
â”‚   â”œâ”€â”€ services/         # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ repositories/     # ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ
â”‚   â”œâ”€â”€ middlewares/      # ì¸ì¦, ê²€ì¦, ì—ëŸ¬ ì²˜ë¦¬
â”‚   â”œâ”€â”€ routes/           # API ì—”ë“œí¬ì¸íŠ¸ ì •ì˜
â”‚   â””â”€â”€ utils/            # ìœ í‹¸ë¦¬í‹° (JWT, ì—ëŸ¬, ì‘ë‹µ)
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma     # ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ migrations/       # ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼
â”œâ”€â”€ md/                   # ë¬¸ì„œ
â”‚   â”œâ”€â”€ step1/            # Phase 1 ì‘ì—… ê¸°ë¡ (13ê°œ ë¬¸ì„œ)
â”‚   â”œâ”€â”€ step2/            # Phase 2 ê³„íš (1ê°œ ë¬¸ì„œ)
â”‚   â”œâ”€â”€ db_*.md           # ë°ì´í„°ë² ì´ìŠ¤ ê°€ì´ë“œ (5ê°œ)
â”‚   â””â”€â”€ *.md              # í”„ë¡œì íŠ¸ ê°€ì´ë“œ (6ê°œ)
â”œâ”€â”€ tests/                # í…ŒìŠ¤íŠ¸ íŒŒì¼ (ê³„íš)
â”œâ”€â”€ .env                  # í™˜ê²½ ë³€ìˆ˜ (í”„ë¡œë•ì…˜)
â”œâ”€â”€ .env.test             # í™˜ê²½ ë³€ìˆ˜ (í…ŒìŠ¤íŠ¸)
â”œâ”€â”€ jest.config.js        # Jest ì„¤ì •
â”œâ”€â”€ package.json          # ì˜ì¡´ì„± ë° ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ README.md             # í”„ë¡œì íŠ¸ ê°œìš” (ë³¸ ë¬¸ì„œ)
```

---

## ğŸš€ ì‹œì‘í•˜ê¸°

### í•„ìˆ˜ ìš”êµ¬ì‚¬í•­

- Node.js v18 ì´ìƒ
- PostgreSQL (ë˜ëŠ” Supabase ê³„ì •)
- npm ë˜ëŠ” yarn

### ì„¤ì¹˜ ë° ì‹¤í–‰

```bash
# 1. ì €ì¥ì†Œ í´ë¡ 
git clone <repository-url>
cd fleecat-backend

# 2. ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# 3. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
# .env íŒŒì¼ ìˆ˜ì • (DATABASE_URL, JWT_SECRET ë“±)

# 4. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
npm run prisma:migrate

# 5. Prisma Client ìƒì„±
npm run prisma:generate

# 6. ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev
```

### ì£¼ìš” ìŠ¤í¬ë¦½íŠ¸

```bash
# ê°œë°œ
npm run dev              # nodemonìœ¼ë¡œ ê°œë°œ ì„œë²„ ì‹¤í–‰
npm start                # í”„ë¡œë•ì…˜ ì„œë²„ ì‹¤í–‰

# ë°ì´í„°ë² ì´ìŠ¤
npm run prisma:generate  # Prisma Client ìƒì„±
npm run prisma:migrate   # ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
npm run prisma:studio    # Prisma Studio (DB GUI) ì‹¤í–‰

# ì½”ë“œ í’ˆì§ˆ
npm run lint             # ESLint ì‹¤í–‰
npm run lint:fix         # ESLint ìë™ ìˆ˜ì •

# í…ŒìŠ¤íŠ¸ (ê³„íš)
npm test                 # ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm run test:watch       # í…ŒìŠ¤íŠ¸ ê°ì‹œ ëª¨ë“œ
```

---

## ğŸ“– API ë¬¸ì„œ

### Phase 1 API (êµ¬í˜„ ì™„ë£Œ)

**Base URL**: `http://localhost:3000/api/v1`

#### ì¸ì¦ (Auth)

| Method | Endpoint | ì„¤ëª… | ì¸ì¦ |
|--------|----------|------|------|
| POST | `/auth/register` | íšŒì›ê°€ì… | - |
| POST | `/auth/login` | ë¡œê·¸ì¸ | - |
| PUT | `/auth/change-password` | ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ | Required |

#### íšŒì› ì •ë³´ (Member)

| Method | Endpoint | ì„¤ëª… | ì¸ì¦ |
|--------|----------|------|------|
| GET | `/members/me` | ë‚´ ì •ë³´ ì¡°íšŒ | Required |
| PUT | `/members/me` | ë‚´ ì •ë³´ ìˆ˜ì • | Required |

### Phase 2 API (ê³„íš)

#### íŒë§¤ì‚¬ (Tenant)

| Method | Endpoint | ì„¤ëª… | ì¸ì¦ |
|--------|----------|------|------|
| POST | `/tenants` | íŒë§¤ì‚¬ ë“±ë¡ ì‹ ì²­ | Required |
| GET | `/tenants/me` | ë‚´ íŒë§¤ì‚¬ ëª©ë¡ | Required |
| GET | `/tenants/:id` | íŒë§¤ì‚¬ ìƒì„¸ ì¡°íšŒ | - |
| PUT | `/tenants/:id` | íŒë§¤ì‚¬ ì •ë³´ ìˆ˜ì • | Owner |
| PUT | `/tenants/:id/approve` | íŒë§¤ì‚¬ ìŠ¹ì¸ | Admin |

#### ì¹´í…Œê³ ë¦¬ (Category)

| Method | Endpoint | ì„¤ëª… | ì¸ì¦ |
|--------|----------|------|------|
| GET | `/categories` | ì¹´í…Œê³ ë¦¬ ëª©ë¡ (ê³„ì¸µí˜•) | - |
| GET | `/categories/:id` | ì¹´í…Œê³ ë¦¬ ìƒì„¸ | - |
| POST | `/categories` | ì¹´í…Œê³ ë¦¬ ìƒì„± | Admin |
| PUT | `/categories/:id` | ì¹´í…Œê³ ë¦¬ ìˆ˜ì • | Admin |
| DELETE | `/categories/:id` | ì¹´í…Œê³ ë¦¬ ì‚­ì œ | Admin |

#### ìƒí’ˆ (Product)

| Method | Endpoint | ì„¤ëª… | ì¸ì¦ |
|--------|----------|------|------|
| GET | `/products` | ìƒí’ˆ ëª©ë¡ (í•„í„°, ì •ë ¬, í˜ì´ì§•) | - |
| GET | `/products/:id` | ìƒí’ˆ ìƒì„¸ ì¡°íšŒ | - |
| POST | `/products` | ìƒí’ˆ ë“±ë¡ | Seller |
| PUT | `/products/:id` | ìƒí’ˆ ìˆ˜ì • | Owner |
| DELETE | `/products/:id` | ìƒí’ˆ ì‚­ì œ | Owner |
| POST | `/products/:id/images` | ìƒí’ˆ ì´ë¯¸ì§€ ì—…ë¡œë“œ | Owner |

---

## ğŸ” ì¸ì¦ ë° ê¶Œí•œ

### JWT í† í° ì‚¬ìš©ë²•

**ë¡œê·¸ì¸ ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "success": true,
  "data": {
    "member": { ... },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

**API ìš”ì²­ ì‹œ**:
```bash
curl -H "Authorization: Bearer {token}" \
  http://localhost:3000/api/v1/members/me
```

### ê¶Œí•œ ë ˆë²¨

| ì—­í•  | ê¶Œí•œ |
|------|------|
| **Guest** | ìƒí’ˆ ì¡°íšŒ, ì¹´í…Œê³ ë¦¬ ì¡°íšŒ |
| **Buyer** | Guest + ì¥ë°”êµ¬ë‹ˆ, ì£¼ë¬¸, ê²°ì œ |
| **Seller** | Buyer + ìƒí’ˆ ë“±ë¡/ìˆ˜ì •, ì£¼ë¬¸ ì²˜ë¦¬ |
| **Admin** | ì „ì²´ ê¶Œí•œ + íŒë§¤ì‚¬ ìŠ¹ì¸, ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ |

---

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ERD

### í•µì‹¬ ê´€ê³„

```
Company (1) â”€â”€â”€â”€â”€â”€â”€â”€ (N) Member
                      â”‚
                      â”œâ”€ (1:1) MemberPermission
                      â”œâ”€ (1:N) MemberAddress
                      â”œâ”€ (1:N) MemberTransaction
                      â”œâ”€ (1:N) Order
                      â”œâ”€ (1:N) ShoppingCart
                      â””â”€ (N:N) â”€â”€â”
                                 â”‚
                          TenantMember
                                 â”‚
                                 â”œâ”€ (N:1) Tenant â”€â”€ (1:1) TenantDetail
                                 â””â”€ (1:N) Product â”€â”€ (1:N) ProductImg
                                            â”‚
                                            â””â”€ (N:1) Category (ê³„ì¸µí˜•)

Order (1) â”€â”€â”€â”€ (1) Payment
  â”‚
  â””â”€ (N:1) Coupon
```

### ì£¼ìš” í…Œì´ë¸”

**ì´ 15ê°œ í…Œì´ë¸”**:
1. íšŒì› & ê¸°ì—… (5ê°œ): `member`, `company`, `member_address`, `member_permissions`, `member_transactions`
2. íŒë§¤ì‚¬ (3ê°œ): `tenant`, `tenant_detail`, `tenant_member`
3. ì¹´í…Œê³ ë¦¬ (1ê°œ): `category`
4. ìƒí’ˆ (2ê°œ): `product`, `product_img`
5. ì¿ í° (1ê°œ): `coupon`
6. ì¥ë°”êµ¬ë‹ˆ (1ê°œ): `shopping_cart`
7. ì£¼ë¬¸ & ê²°ì œ (2ê°œ): `order`, `payment`

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ

### Phase 1 í…ŒìŠ¤íŠ¸ ê²°ê³¼

**ìˆ˜ë™ í…ŒìŠ¤íŠ¸ (Manual Testing)**:
- ë„êµ¬: curl, Postman
- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤: 20ê°œ (ì™„ë£Œ: 12ê°œ, í†µê³¼ìœ¨: 100%)
- ë²„ê·¸ ë°œê²¬: 5ê°œ Critical (ëª¨ë‘ ìˆ˜ì • ì™„ë£Œ)

**í…ŒìŠ¤íŠ¸ ë¬¸ì„œ**:
- `md/step1/test/change-password.md` - ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ (4/7 ì¼€ì´ìŠ¤)
- `md/step1/test/member-get-me.md` - ë‚´ ì •ë³´ ì¡°íšŒ (4/4 ì¼€ì´ìŠ¤)
- `md/step1/test/member-update-me.md` - ë‚´ ì •ë³´ ìˆ˜ì • (4/5 ì¼€ì´ìŠ¤)

### í–¥í›„ ê³„íš

**ìë™í™” í…ŒìŠ¤íŠ¸** (Phase 2+):
- Jest ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Repository, Service ê³„ì¸µ)
- Supertest í†µí•© í…ŒìŠ¤íŠ¸ (API ì—”ë“œí¬ì¸íŠ¸)
- ì»¤ë²„ë¦¬ì§€ ëª©í‘œ: 80% ì´ìƒ

---

## ğŸ“š ë¬¸ì„œ

### í”„ë¡œì íŠ¸ ê°€ì´ë“œ
- `md/01_README.md` - í”„ë¡œì íŠ¸ êµ¬ì¡° ë° ê°œìš”
- `md/02_CODING_STANDARDS.md` - ì½”ë”© í‘œì¤€ ë° ë„¤ì´ë° ê·œì¹™
- `md/03_ARCHITECTURE.md` - ì•„í‚¤í…ì²˜ ë° ë””ìì¸ íŒ¨í„´
- `md/04_API_DEVELOPMENT.md` - API ê°œë°œ ê°€ì´ë“œ
- `md/05_TESTING_DEPLOYMENT.md` - í…ŒìŠ¤íŠ¸ ë° ë°°í¬
- `md/06_COLLABORATION.md` - í˜‘ì—… ê°€ì´ë“œ

### ë°ì´í„°ë² ì´ìŠ¤ ê°€ì´ë“œ
- `md/db_00_INDEX.md` - ë°ì´í„°ë² ì´ìŠ¤ ë¬¸ì„œ ëª©ì°¨
- `md/db_01_VARIABLE_REFERENCE.md` - ë³€ìˆ˜ ë¹ ë¥¸ ì°¸ì¡°
- `md/db_02_NAMING_DATATYPES.md` - ë„¤ì´ë° ê·œì¹™ & ë°ì´í„° íƒ€ì…
- `md/db_03_RELATIONSHIPS.md` - ë³€ìˆ˜ ê´€ê³„ë„ & FK

### Phaseë³„ ì‘ì—… ê¸°ë¡
- `md/step1/00_INDEX.md` - Phase 1 ì‘ì—… ê¸°ë¡ (13ê°œ Step)
- `md/step2/00_INDEX.md` - Phase 2 ê³„íš (14ê°œ Step)

### API ê°œë°œ ê³„íš
- `md/api_develop_plan.md` - ì „ì²´ API ê°œë°œ ë¡œë“œë§µ

---

## ğŸ”§ í™˜ê²½ ë³€ìˆ˜

**í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜** (`.env`):

```env
# Database
DATABASE_URL=postgresql://user:password@host:5432/database
DIRECT_URL=postgresql://user:password@host:5432/database

# Supabase (ì„ íƒ)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key

# JWT
JWT_SECRET=your-secret-key-here
JWT_EXPIRES_IN=7d

# CORS
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Server
PORT=3000
NODE_ENV=development
```

---

## ğŸ“ˆ ì„±ê³¼ ë° í†µê³„

### Phase 1 (ì™„ë£Œ)

**ê°œë°œ ê¸°ê°„**: 2ì¼ (2025.10.01 ~ 2025.10.02)

**ì‘ì—…ëŸ‰**:
- ì½”ë“œ íŒŒì¼: 13ê°œ (Repository 2ê°œ, Service 2ê°œ, Controller 2ê°œ, Routes 2ê°œ, Middleware 3ê°œ, Utils 2ê°œ)
- ë¬¸ì„œ: 16ê°œ (Step ê¸°ë¡ 13ê°œ, í…ŒìŠ¤íŠ¸ ê²°ê³¼ 3ê°œ)
- API ì—”ë“œí¬ì¸íŠ¸: 5ê°œ
- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤: 12ê°œ (í†µê³¼ìœ¨ 100%)

**ë²„ê·¸ ë°œê²¬ ë° ìˆ˜ì •**: 5ê°œ Critical

**ì£¼ìš” í•™ìŠµ**:
- Prisma ORM ê´€ê³„ í•„ë“œëª… ì •í™•ë„ ì¤‘ìš”ì„±
- BigInt ì§ë ¬í™” ì²˜ë¦¬ ë°©ë²•
- JWT í† í° ê¸°ë°˜ ì¸ì¦ êµ¬í˜„
- Repository íŒ¨í„´ ì ìš©

---

## ğŸ¤ ê¸°ì—¬ ê°€ì´ë“œ

### ì½”ë”© í‘œì¤€

- **ë„¤ì´ë°**: camelCase (ë³€ìˆ˜, í•¨ìˆ˜), PascalCase (í´ë˜ìŠ¤, ì»´í¬ë„ŒíŠ¸)
- **íŒŒì¼ëª…**: kebab-case (`auth.controller.js`, `member.repository.js`)
- **ì»¤ë°‹ ë©”ì‹œì§€**: `type: subject` í˜•ì‹ (ì˜ˆ: `feat: Add product API`)
- **ì£¼ì„**: JSDoc í˜•ì‹ ì‚¬ìš©

### ë¸Œëœì¹˜ ì „ëµ

```
main (í”„ë¡œë•ì…˜)
  â””â”€â”€ develop (ê°œë°œ)
       â”œâ”€â”€ feature/phase-1 (ì™„ë£Œ)
       â”œâ”€â”€ feature/phase-2 (ì˜ˆì •)
       â””â”€â”€ feature/phase-3 (ì˜ˆì •)
```

---

## ğŸ“ ë¬¸ì˜ ë° ì§€ì›

**í”„ë¡œì íŠ¸ ê´€ë¦¬**: Backend Team
**ë¬¸ì„œ ì‘ì„±ì¼**: 2025ë…„ 10ì›” 2ì¼
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025ë…„ 10ì›” 2ì¼

---

## ğŸ“œ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” í•™ìŠµ ë° í¬íŠ¸í´ë¦¬ì˜¤ ëª©ì ìœ¼ë¡œ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.

---

**í˜„ì¬ ìƒíƒœ**: Phase 1 ì™„ë£Œ âœ…, Phase 2 ê³„íš ìˆ˜ë¦½ ì™„ë£Œ ğŸ“‹
**ë‹¤ìŒ ë‹¨ê³„**: Phase 2 êµ¬í˜„ ì‹œì‘ (Tenant & Product ê´€ë¦¬)
